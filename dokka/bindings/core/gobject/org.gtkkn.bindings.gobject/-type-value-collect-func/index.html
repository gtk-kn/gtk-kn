<!doctype html>
<html class="no-js">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>TypeValueCollectFunc</title>
<link href="../../../../../images/logo-icon.svg" rel="icon" type="image/svg">    <script>var pathToRoot = "../../../../../";</script>
    <script>document.documentElement.classList.replace("no-js","js");</script>
    <script>const storage = localStorage.getItem("dokka-dark-mode")
    if (storage == null) {
        const osDarkSchemePreferred = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        if (osDarkSchemePreferred === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    } else {
        const savedDarkMode = JSON.parse(storage)
        if(savedDarkMode === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    }
    </script>
<script type="text/javascript" src="https://unpkg.com/kotlin-playground@1/dist/playground.min.js" async></script>
<script type="text/javascript" src="../../../../../scripts/sourceset_dependencies.js" async></script>
<link href="../../../../../styles/style.css" rel="Stylesheet">
<link href="../../../../../styles/main.css" rel="Stylesheet">
<link href="../../../../../styles/prism.css" rel="Stylesheet">
<link href="../../../../../styles/logo-styles.css" rel="Stylesheet">
<link href="../../../../../styles/font-jb-sans-auto.css" rel="Stylesheet">
<link href="../../../../../ui-kit/ui-kit.min.css" rel="Stylesheet">
<script type="text/javascript" src="../../../../../scripts/clipboard.js" async></script>
<script type="text/javascript" src="../../../../../scripts/navigation-loader.js" async></script>
<script type="text/javascript" src="../../../../../scripts/platform-content-handler.js" async></script>
<script type="text/javascript" src="../../../../../scripts/main.js" defer></script>
<script type="text/javascript" src="../../../../../scripts/prism.js" async></script>
<script type="text/javascript" src="../../../../../ui-kit/ui-kit.min.js" defer></script>
<script type="text/javascript" src="../../../../../scripts/symbol-parameters-wrapper_deferred.js" defer></script></head>
<body>
    <div class="root">
    <nav class="navigation theme-dark" id="navigation-wrapper">
<a class="library-name--link" href="../../../../../index.html">
                    gtk-kn
            </a>        <button class="navigation-controls--btn navigation-controls--btn_toc ui-kit_mobile-only" id="toc-toggle" type="button">Toggle table of contents
        </button>
        <div class="navigation-controls--break ui-kit_mobile-only"></div>
        <div class="library-version" id="library-version">
        </div>
        <div class="navigation-controls">
        <div class="filter-section filter-section_loading" id="filter-section">
                <button class="platform-tag platform-selector native-like" data-active="" data-filter=":bindings:core:gobject/nativeMain">native</button>
            <div class="dropdown filter-section--dropdown" data-role="dropdown" id="filter-section-dropdown">
                <button class="button button_dropdown filter-section--dropdown-toggle" role="combobox" data-role="dropdown-toggle" aria-controls="platform-tags-listbox" aria-haspopup="listbox" aria-expanded="false" aria-label="Toggle source sets"></button>
                <ul role="listbox" id="platform-tags-listbox" class="dropdown--list" data-role="dropdown-listbox">
                    <div class="dropdown--header"><span>Platform filter</span>
                        <button class="button" data-role="dropdown-toggle" aria-label="Close platform filter">
                            <i class="ui-kit-icon ui-kit-icon_cross"></i>
                        </button>
                    </div>
                        <li role="option" class="dropdown--option platform-selector-option native-like" tabindex="0">
                            <label class="checkbox">
                                <input type="checkbox" class="checkbox--input" id=":bindings:core:gobject/nativeMain" data-filter=":bindings:core:gobject/nativeMain">
                                <span class="checkbox--icon"></span>
                                native
                            </label>
                        </li>
                </ul>
                <div class="dropdown--overlay"></div>
            </div>
        </div>
            <button class="navigation-controls--btn navigation-controls--btn_theme" id="theme-toggle-button" type="button">Switch theme
            </button>
            <div class="navigation-controls--btn navigation-controls--btn_search" id="searchBar" role="button">Search in
                API
            </div>
        </div>
    </nav>
        <div id="container">
            <div class="sidebar" id="leftColumn">
                <div class="dropdown theme-dark_mobile" data-role="dropdown" id="toc-dropdown">
                    <ul role="listbox" id="toc-listbox" class="dropdown--list dropdown--list_toc-list" data-role="dropdown-listbox">
                        <div class="dropdown--header">
                            <span>
                                    gtk-kn
                            </span>
                            <button class="button" data-role="dropdown-toggle" aria-label="Close table of contents">
                                <i class="ui-kit-icon ui-kit-icon_cross"></i>
                            </button>
                        </div>
                        <div class="sidebar--inner" id="sideMenu"></div>
                    </ul>
                    <div class="dropdown--overlay"></div>
                </div>
            </div>
            <div id="main">
<div class="main-content" data-page-type="classlike" id="content" pageids="gobject::org.gtkkn.bindings.gobject/TypeValueCollectFunc///PointingToDeclaration//-793642492">
  <div class="breadcrumbs"><a href="../../index.html">gobject</a><span class="delimiter">/</span><a href="../index.html">org.gtkkn.bindings.gobject</a><span class="delimiter">/</span><span class="current">TypeValueCollectFunc</span></div>
  <div class="cover ">
    <h1 class="cover"><span>Type</span><wbr><span>Value</span><wbr><span>Collect</span><wbr><span><span>Func</span></span></h1>
    <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":bindings:core:gobject/nativeMain"><div class="symbol monospace"><span class="token keyword">typealias </span><a href="index.html">TypeValueCollectFunc</a><span class="token operator"> = </span><span class="token punctuation">(</span>value<span class="token operator">: </span><a href="../-value/index.html">Value</a><span class="token punctuation">, </span><span data-unresolved-link="/<Error class: unknown class>///PointingToDeclaration/">&lt;Error class: unknown class&gt;</span><span class="token punctuation">, </span><span data-unresolved-link="/<Error class: unknown class>///PointingToDeclaration/">&lt;Error class: unknown class&gt;</span><span class="token punctuation">)</span><span class="token operator"> -&gt; </span><a href="https://kotlinlang.org/api/core/kotlin-stdlib/kotlin/-string/index.html">String</a><span class="token operator">?</span></div><p class="paragraph">This function is responsible for converting the values collected from a variadic argument list into contents suitable for storage in a #GValue.</p><p class="paragraph">This function should setup @value similar to #GTypeValueInitFunc; e.g. for a string value that does not allow <code class="lang-kotlin">NULL</code> pointers, it needs to either emit an error, or do an implicit conversion by storing an empty string.</p><p class="paragraph">The @value passed in to this function has a zero-filled data array, so just like for #GTypeValueInitFunc it is guaranteed to not contain any old contents that might need freeing.</p><p class="paragraph">The @n_collect_values argument is the string length of the <code class="lang-kotlin">collect_format</code> field of #GTypeValueTable, and <code class="lang-kotlin">collect_values</code> is an array of #GTypeCValue with length of @n_collect_values, containing the collected values according to <code class="lang-kotlin">collect_format</code>.</p><p class="paragraph">The @collect_flags argument provided as a hint by the caller. It may contain the flag %G_VALUE_NOCOPY_CONTENTS indicating that the collected value contents may be considered ‘static’ for the duration of the @value lifetime. Thus an extra copy of the contents stored in @collect_values is not required for assignment to @value.</p><p class="paragraph">For our above string example, we continue with:</p><p class="paragraph">|[<!-- language="C" --> if (!collect_values0.v_pointer) value-&gt;data0.v_pointer = g_strdup (""); else if (collect_flags &amp; G_VALUE_NOCOPY_CONTENTS) {     value-&gt;data0.v_pointer = collect_values0.v_pointer;     // keep a flag for the value_free() implementation to not free this string     value-&gt;data1.v_uint = G_VALUE_NOCOPY_CONTENTS; } else value-&gt;data0.v_pointer = g_strdup (collect_values0.v_pointer); return NULL; ]|</p><p class="paragraph">It should be noted, that it is generally a bad idea to follow the %G_VALUE_NOCOPY_CONTENTS hint for reference counted types. Due to reentrancy requirements and reference count assertions performed by the signal emission code, reference counts should always be incremented for reference counted contents stored in the <code class="lang-kotlin">value-&gt;data</code> array. To deviate from our string example for a moment, and taking a look at an exemplary implementation for <code class="lang-kotlin">GTypeValueTable.collect_value()</code> of <code class="lang-kotlin">GObject</code>:</p><p class="paragraph">|[<!-- language="C" --> GObject *object = G_OBJECT (collect_values0.v_pointer); g_return_val_if_fail (object != NULL,     g_strdup_printf ("Object %p passed as invalid NULL pointer", object)); // never honour G_VALUE_NOCOPY_CONTENTS for ref-counted types value-&gt;data0.v_pointer = g_object_ref (object); return NULL; ]|</p><p class="paragraph">The reference count for valid objects is always incremented, regardless of <code class="lang-kotlin">collect_flags</code>. For invalid objects, the example returns a newly allocated string without altering <code class="lang-kotlin">value</code>.</p><p class="paragraph">Upon success, <code class="lang-kotlin">collect_value()</code> needs to return <code class="lang-kotlin">NULL</code>. If, however, an error condition occurred, <code class="lang-kotlin">collect_value()</code> should return a newly allocated string containing an error diagnostic.</p><p class="paragraph">The calling code makes no assumptions about the <code class="lang-kotlin">value</code> contents being valid upon error returns, <code class="lang-kotlin">value</code> is simply thrown away without further freeing. As such, it is a good idea to not allocate <code class="lang-kotlin">GValue</code> contents prior to returning an error; however, <code class="lang-kotlin">collect_values()</code> is not obliged to return a correctly setup @value for error returns, simply because any non-<code class="lang-kotlin">NULL</code> return is considered a fatal programming error, and further program behaviour is undefined.</p><ul><li><p class="paragraph">param <code class="lang-kotlin">value</code> the value to initialize</p></li><li><p class="paragraph">param <code class="lang-kotlin">nCollectValues</code> the number of collected values</p></li><li><p class="paragraph">param <code class="lang-kotlin">collectFlags</code> optional flags</p></li><li><p class="paragraph">return <code class="lang-kotlin">NULL</code> on success, otherwise a newly allocated error string on failure</p></li></ul></div></div>
  </div>
  <div class="tabbedcontent">
    <div class="tabs-section" tabs-section="tabs-section"></div>
    <div class="tabs-section-body"></div>
  </div>
</div>
    <div class="footer">
        <a href="#content" id="go-to-top-link" class="footer--button footer--button_go-to-top"></a>
        <span>© 2025 Copyright</span>
        <span class="pull-right">
            <span>Generated by </span>
            <a class="footer--link footer--link_external" href="https://github.com/Kotlin/dokka">
                <span>dokka</span>
            </a>
        </span>
    </div>
            </div>
        </div>
    </div>
</body>
</html>
