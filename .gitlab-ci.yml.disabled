image: openjdk:11-jdk

workflow:
  rules:
    - if: '$CI_PIPELINE_SOURCE == "merge_request_event" && $CI_MERGE_REQUEST_TARGET_BRANCH_NAME == "master"'

before_script:
  - GRADLE_USER_HOME="$(pwd)/.gradle"
  - export GRADLE_USER_HOME

stages:
  - build
  - test

assemble-gir:
  interruptible: true
  stage: build
  script:
    - ./gradlew :gir:assemble

assemble-samples:
  interruptible: true
  stage: build
  script:
    - ./gradlew :samples:gtk:hello-world:assemble


check:
  stage: test
  script:
    - ./gradlew check
